%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Incremental solution (for free degrees of freedom)
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  
function dU                 =  NewSolveSystemEquations(freedof,fixdof,K,R,dU)

reduced_matrix              =  K;
reduced_matrix(fixdof,:)    =  [];
reduced_matrix(:,fixdof)    =  [];
%--------------------------------------------------------------------------
% Incremental solution
%--------------------------------------------------------------------------
dU(freedof)                 =  reduced_matrix\R(freedof,1); 
