#include "mex.h"
#include "matfunctions.h"

/* */
/*-----------------------------------------------------------------------*/
/*-----------------------------------------------------------------------*/
/* The C function */
/*-----------------------------------------------------------------------*/
/*-----------------------------------------------------------------------*/
void perfomer(mwSize dim_iA,
        mwSize dim_jA,
        mwSize dim_jB,
        const double *A,
        const double *B,
        double *C)
{
    matmul(dim_iA,dim_jA,dim_jB,A,B,C);
}

/*-----------------------------------------------------------------------*/
/*-----------------------------------------------------------------------*/
/* The gateway function */
/*-----------------------------------------------------------------------*/
/*-----------------------------------------------------------------------*/
void mexFunction( int nlhs, mxArray *plhs[],
                  int nrhs, const mxArray *prhs[])
{
    /*-------------------------------------------------------------------*/
    /*Inputs and declaration*/
    /*-------------------------------------------------------------------*/
    size_t dim_iA, dim_jA, dim_jB;
    double *A;               /* input matrix */
    double *B;               /* input matrix */
    /*-------------------------------------------------------------------*/
    /* outputs */
    /*-------------------------------------------------------------------*/
    double *C;              /* output matrix */
    /*-------------------------------------------------------------------*/
    /* create a pointer to the real data in the input matrix  */
    /*-------------------------------------------------------------------*/
    dim_iA             =  mxGetM(prhs[0]);
    dim_jA             =  mxGetN(prhs[0]);
    dim_jB             =  mxGetN(prhs[1]);
    A                  =  mxGetPr(prhs[0]);
    B                  =  mxGetPr(prhs[1]);    
    plhs[0]            =  mxCreateDoubleMatrix((mwSize)dim_iA,(mwSize)dim_jB,mxREAL);
    /*-------------------------------------------------------------------*/
    /* get a pointer to the real data in the output matrix */
    /*-------------------------------------------------------------------*/
    C                  =  mxGetPr(plhs[0]);
    /*-------------------------------------------------------------------*/
    /* call the computational routine */
    /*-------------------------------------------------------------------*/
    perfomer((mwSize)dim_iA,(mwSize)dim_jA,(mwSize)dim_jB,A,B,C);
}


